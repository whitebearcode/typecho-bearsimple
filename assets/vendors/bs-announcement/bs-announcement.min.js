/*!
*  
* 公告组件
*
*/

!function(a,b,c,d){'use strict';function e(b,c){return'remove'===this.getCookie('jquery.'+f)?void a(b).remove():(this.element=b,this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this.nodes={},this.size=0,this.current=0,this.count=0,this.isHide=!1,this.isClose=!0,this.run=d,this.build(),void this.init())}var f='announcement',g={title:'Announcement',showToggle:!0,showClose:!1,autoHide:'auto',autoClose:0,position:'bottom-left',width:300,height:'auto',zIndex:99999,speed:10,effect:'fading'},h=a(b);a.extend(e.prototype,{detectCSSFeature:function(a){var b=!1,e='Webkit Moz ms O'.split(' '),f=c.createElement('div'),g=null;if(a=a.toLowerCase(),f.style[a]!==d&&(b=!0),b===!1){g=a.charAt(0).toUpperCase()+a.substr(1);for(var h=0;h<e.length;h++)if(f.style[e[h]+g]!==d){b=!0;break}}return b},debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},getCookie:function(a){var b,d,e=a+'=',f=c.cookie.indexOf(e);return f!==-1?(b=f+e.length,d=c.cookie.indexOf(';',b),d===-1&&(d=c.cookie.length),decodeURIComponent(c.cookie.substring(b,d))):null},setCookie:function(a,b,d,e){var f='',g=new Date;d&&(g.setTime(g.getTime()+24*d*60*60*1e3),d='; expires='+g.toUTCString()),e||(e='/'),c.cookie=a+'='+b+'; path='+e+d+f+';'},randomEffect:function(a){var b='zoom-in zoom-out rotate-left rotate-right move-top move-right move-bottom move-left skew-top skew-right skew-bottom skew-left';return a&&this.nodes.list.removeClass(b),b=b.split(' '),b=b[Math.floor(Math.random()*b.length)]},genNode:function(b){return a('<div>',{class:f+'-'+b})},build:function(){var b,c,d,e=this,g=e.settings,h=g.effect,i=e.genNode('wrap'),j=e.genNode('title'),k=e.genNode('content'),l=e.genNode('button'),m=a(e.element).addClass(f+'-list'),n=m.children('li'),o=this.genNode('paging');e.size=n.length,e.size&&(k.append(m),i.addClass(g.position),i.append(l).append(j).append(k).appendTo('body'),99999!==g.zIndex&&'number'==typeof g.zIndex&&i.css('z-index',g.zIndex),g.showClose&&(c=e.genNode('close'),l.append(c)),g.showToggle&&(b=e.genNode('toggle'),l.append(b)),g.showToggle||g.showClose||j.addClass('no-button'),g.showToggle&&g.showClose&&j.addClass('two-button'),''!==g.title&&j.text(g.title),'fading'!==h&&e.detectCSSFeature('transform')?'random'!==g.effect&&'shuffle'!==g.effect||(h=e.randomEffect()+' fading'):h='fading',m.addClass(h),e.size>1&&(k.append(o),n.each(function(b){var c=a('<span>',{'data-index':b,text:b+1});c.appendTo(o),d=0===b?c:d.add(c)})),e.nodes={wrap:i,title:j,content:k,toggle:b,close:c,list:m,items:n,numbers:d},e.autoResize(),'hidden'===e.getCookie('jquery.'+f)&&(i.addClass('bsmhidden'),k.hide(),e.isHide=!0,0!==g.autoHide&&(g.autoHide=0)),e.isClose=!1)},autoResize:function(){var b,c,d=this.settings,e=this.nodes.wrap,f=this.nodes.list,g=this.nodes.items,i=this.nodes.content,j=h.height(),k=h.width(),l=0;e.add(f).css({width:'auto',height:'auto'}),this.isHide&&i.show(),'auto'===d.width&&(d.width=f.width()),f.width(d.width),e.width(e.width()),c=e.outerWidth(),c>k&&(e.width(k-2),f.width(k-(c-f.outerWidth()))),1===this.size?l=g.eq(0).height():g.each(function(){var b=a(this).height();b>l&&(l=b)}),'auto'!==d.height&&'number'===a.type(d.height)&&(l=d.height),l>0&&f.height(l),b=e.outerHeight(),b>j&&f.height(j-(b-l)),g.css({width:f.width(),height:f.height()}),this.isHide&&i.hide()},active:function(a){var b=this.nodes,c=this.settings,d=b.items.eq(a);d.length&&('shuffle'===c.effect&&b.list.addClass(this.randomEffect(!0)),b.content.find('.active').removeClass('active'),b.items.eq(a).addClass('active'),this.size>1&&b.numbers.eq(a).addClass('active'),this.current=a,this.count++,this.count>this.size&&('auto'===c.autoHide&&(this.toggle(),c.autoHide=0),'auto'===c.autoClose&&(this.close(),c.autoClose=0)))},start:function(){var a=this,b=a.settings;0===b.speed||1===a.size||a.isHide||a.isClose||(a.current++,a.current>=a.size&&(a.current=0),clearTimeout(a.run),a.run=setTimeout(function(){a.active(a.current),a.start()},1e3*b.speed))},stop:function(){0===this.settings.speed||1===this.size||this.isHide||this.isClose||!this.run||(clearTimeout(this.run),this.run=d,this.current--)},toggle:function(){var a=this,b=this.nodes.wrap;a.isClose||a.nodes.content.stop(!0,!1).slideToggle('slow',function(){a.isClose||(a.isHide?(b.removeClass('bsmhidden'),a.isHide=!1,a.start(),a.setCookie('jquery.'+f,'hidden',-1)):(b.addClass('bsmhidden'),a.isHide=!0,a.stop(),a.setCookie('jquery.'+f,'hidden',1)))})},close:function(){var a=this,b=a.nodes.wrap;a.isClose||(this.stop(),b.fadeOut('slow',function(){a.isClose||(b.remove(),a.isClose=!0)}),this.setCookie('jquery.'+f,'remove',1))},init:function(){var b,c=this,d=c.settings,e=c.nodes;0===c.size||c.isClose||(c.active(c.current),c.start(),b=c.debounce(function(){c.autoResize()},250),h.on('resize',b),c.size>1&&e.numbers.on('click',function(){var b=a(this).data('index');c.active(b),0!==d.autoHide&&(d.autoHide=0),0!==d.autoClose&&(d.autoClose=0)}),d.showToggle&&e.toggle.on('click',function(){c.toggle()}),d.showClose&&e.close.on('click',function(){c.close()}),d.speed>0&&e.wrap.on('mouseleave',function(){c.start()}).on('mouseenter',function(){c.stop()}),('number'==typeof d.autoHide&&d.autoHide>0||'auto'===d.autoHide&&1===c.size)&&('auto'===d.autoHide&&(d.autoHide=d.speed),setTimeout(function(){c.isHide||c.toggle()},1e3*d.autoHide)),('number'==typeof d.autoClose&&d.autoClose>0||'auto'===d.autoClose&&1===c.size)&&('auto'===d.autoClose&&(d.autoClose=d.speed),setTimeout(function(){c.close()},1e3*d.autoClose)))}}),a.fn[f]=function(b){return this.each(function(){a.data(this,'plugin_'+f)||a.data(this,'plugin_'+f,new e(this,b))})}}(jQuery,window,document);